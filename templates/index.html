<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ν¬λν”„ν†¤ μ •κΈ€ μ™μ†λ™ μ„Ένƒμ‹¤ ν„ν™©</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="{{url_for('static', filename="css/style.css")}}" />
    <link rel="stylesheet" href="{{url_for('static', filename="css/machine.css")}}" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
  </head>
  <body>
    <div class="container-fluid main-container">
      <div class="main-header">
        <div class="row mb-4">
          <div class="col-12">
            <div class="header-container">
              <img
                src="https://jungle.krafton.com/resource/images/common/logo.svg"
                alt="ν¬λν”„ν†¤ μ •κΈ€ λ΅κ³ "
                class="logo-img"
              />
              <h1 class="main-title">π§Ί μ •κΈ€μΊ νΌμ¤ μ™μ† μ„Ένƒμ‹¤ ν„ν™©</h1>
            </div>

            <!-- μ„±λ³„ μ„ νƒ λΌλ””μ¤ λ²„νΌ -->
            <div class="gender-selector">
              <div class="btn-group" role="group" aria-label="μ„±λ³„ μ„ νƒ">
                <input
                  type="radio"
                  class="btn-check"
                  name="genderSelect"
                  id="maleRadio"
                  value="male"
                  checked
                  autocomplete="off"
                  onchange="refreshData('λ‚¨μ')"
                />
                <label
                  class="btn btn-outline-primary gender-btn"
                  for="maleRadio"
                  >λ‚¨μ μ„Ένƒμ‹¤</label
                >

                <input
                  type="radio"
                  class="btn-check"
                  name="genderSelect"
                  id="femaleRadio"
                  value="female"
                  autocomplete="off"
                  onchange="refreshData('μ—¬μ')"
                />
                <label
                  class="btn btn-outline-danger gender-btn"
                  for="femaleRadio"
                >
                  μ—¬μ μ„Ένƒμ‹¤
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ν„ν™© ν†µκ³„ - μµμ… 3: μ»΄ν©νΈ λ‚λ€ν λ°°μΉ -->
      <div class="row mb-4">
        <div class="col-md-6 mb-3">
          <div class="compact-stats">
            <div class="text-center me-3">
              <i class="fas fa-tint text-primary fs-2"></i>
              <h5 class="mt-2 mb-0">μ„ΈνƒκΈ°</h5>
            </div>
            <div class="compact-stat">
              <h5 class="text-success" id="washer-available">0</h5>
              <small>μ‚¬μ©κ°€λ¥</small>
            </div>
            <div class="compact-stat">
              <h5 class="text-primary" id="washer-running">0</h5>
              <small>μ‚¬μ©μ¤‘</small>
            </div>
            <div class="compact-stat">
              <h5 class="text-warning" id="washer-maintenance">0</h5>
              <small>μ κ²€μ¤‘</small>
            </div>
            <div class="compact-stat">
              <h5 class="text-info machine-timer" id="washer-next">--</h5>
              <small>λ‹¤μμ΄μ©</small>
            </div>
          </div>
        </div>
        <div class="col-md-6 mb-3">
          <div class="compact-stats">
            <div class="text-center me-3">
              <i class="fas fa-wind text-warning fs-2"></i>
              <h5 class="mt-2 mb-0">κ±΄μ΅°κΈ°</h5>
            </div>
            <div class="compact-stat">
              <h5 class="text-success" id="dryer-available">0</h5>
              <small>μ‚¬μ©κ°€λ¥</small>
            </div>
            <div class="compact-stat">
              <h5 class="text-primary" id="dryer-running">0</h5>
              <small>μ‚¬μ©μ¤‘</small>
            </div>
            <div class="compact-stat">
              <h5 class="text-warning" id="dryer-maintenance">0</h5>
              <small>μ κ²€μ¤‘</small>
            </div>
            <div class="compact-stat">
              <h5 class="text-info machine-timer" id="dryer-next">--</h5>
              <small>λ‹¤μμ΄μ©</small>
            </div>
          </div>
        </div>
      </div>

      <!-- μ„ΈνΈ μΉ΄λ“λ“¤μ΄ λ“¤μ–΄κ°€λ” μμ—­ -->
      <div class="row" id="machineSetContainer"></div>
    </div>

    <!-- λ¨λ‹¬ -->
    <div class="modal fade" id="startMachineModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header"><h5>μ‚¬μ© μ‹μ‘</h5></div>
          <div class="modal-body">
            <input
              id="inputUserName"
              class="form-control mb-2"
              placeholder="μ΄λ¦„"
            />
            <input
              id="inputRoomNumber"
              class="form-control mb-2"
              placeholder="νΈμ‹¤"
            />
            <div class="row g-2">
              <div class="col-6">
                <label class="form-label text-center d-block">μ‹κ°„</label>
                <input
                  id="inputHours"
                  class="form-control text-center"
                  type="number"
                  placeholder="0"
                  min="0"
                  max="5"
                />
              </div>
              <div class="col-6">
                <label class="form-label text-center d-block">λ¶„</label>
                <input
                  id="inputMinutes"
                  class="form-control text-center"
                  type="number"
                  placeholder="0"
                  min="0"
                  max="59"
                />
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" data-bs-dismiss="modal">
              μ·¨μ†
            </button>
            <button class="btn btn-primary" id="confirmStartBtn">μ‹μ‘</button>
          </div>
        </div>
      </div>
    </div>

    <!-- μ¤‘λ‹¨ ν™•μΈ λ¨λ‹¬ -->
    <div class="modal fade" id="stopMachineModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5>μ‚¬μ© μ¤‘λ‹¨</h5>
          </div>
          <div class="modal-body text-center">
            <i class="fas fa-exclamation-triangle text-warning fs-1 mb-3"></i>
            <p class="fs-5">μ •λ§ μ¤‘λ‹¨ν•μ‹κ² μµλ‹κΉ?</p>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" data-bs-dismiss="modal">
              μ·¨μ†
            </button>
            <button class="btn btn-danger" id="confirmStopBtn">μ¤‘λ‹¨</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ν† μ¤νΈ -->
    <!-- <div class="toast-container position-fixed bottom-0 end-0 p-3">
      <div id="machineToast" class="toast" role="alert">
        <div class="toast-header">
          <strong class="me-auto">μ•λ¦Ό</strong>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="toast"
          ></button>
        </div>
        <div class="toast-body"></div>
      </div>
    </div> -->

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="{{url_for('static', filename="js/main.js")}}"></script>

    <script>
      // λΌλ””μ¤ λ²„νΌ λ³€κ²½ μ΄λ²¤νΈ λ¦¬μ¤λ„
      document.addEventListener("DOMContentLoaded", function () {
        const radioButtons = document.querySelectorAll(
          'input[name="genderSelect"]'
        );
        radioButtons.forEach((radio) => {
          radio.addEventListener("change", handleGenderChange);
        });
      });

      // μλ™μΌλ΅ λ¶„ ν•„λ“λ΅ ν¬μ»¤μ¤ μ΄λ™
      document.addEventListener("DOMContentLoaded", function () {
        const hoursInput = document.getElementById("inputHours");
        const minutesInput = document.getElementById("inputMinutes");

        // μ‹κ°„ ν•„λ“ ν΄λ¦­/ν¬μ»¤μ¤ μ‹ μ „μ²΄ μ„ νƒ
        hoursInput.addEventListener("focus", function () {
          this.select();
        });

        // λ¶„ ν•„λ“ ν΄λ¦­/ν¬μ»¤μ¤ μ‹ μ „μ²΄ μ„ νƒ
        minutesInput.addEventListener("focus", function () {
          this.select();
        });

        // μ‹κ°„ μ…λ ¥ μ‹ μλ™μΌλ΅ λ¶„ ν•„λ“λ΅ μ΄λ™
        hoursInput.select();
        hoursInput.addEventListener("input", function () {
          if (this.value.length >= 1) {
            minutesInput.focus();
            minutesInput.select();
          }
        });

        // Enter ν‚¤ μ…λ ¥ μ‹μ—λ„ λ‹¤μ ν•„λ“λ΅ μ΄λ™ -κµ³μ΄?
        hoursInput.addEventListener("keydown", function (e) {
          if (e.key === "Enter" || e.key === "Tab") {
            e.preventDefault();
            minutesInput.focus();
          }
        });

        // λ¶„ μ…λ ¥μ—μ„ Enter ν‚¤ μ‹ ν™•μΈ λ²„νΌ ν΄λ¦­ -κµ³μ΄?
        minutesInput.addEventListener("keydown", function (e) {
          if (e.key === "Enter") {
            e.preventDefault();
            document.getElementById("confirmStartBtn").click();
          }
        });
      });
      document
        .getElementById("confirmStartBtn")
        .addEventListener("click", confirmStart);
      document
        .getElementById("confirmStopBtn")
        .addEventListener("click", (e) => {
          console.log(e.target.value);
          confirmStop();
        });
      // document
      //   .getElementById("confirmStopBtn")
      //   .addEventListener("click", () => {
      //     confirmStop();
      //   });
    </script>
  </body>
</html>
